using QuestionarioOnline.Application.DTOs.Responses;

namespace QuestionarioOnline.Api.Contracts.Responses;

/// <summary>
/// Response com resultados/estatísticas do questionário (API Contract)
/// </summary>
public record ResultadoQuestionarioResponse(
    Guid Id,
    string Titulo,
    int TotalRespostas,
    List<ResultadoPerguntaResponse> Perguntas
)
{
    public static ResultadoQuestionarioResponse From(ResultadoQuestionarioDto dto) => new(
        dto.Id,
        dto.Titulo,
        dto.TotalRespostas,
        dto.Perguntas.Select(ResultadoPerguntaResponse.From).ToList()
    );
}

/// <summary>
/// Response com resultado de uma pergunta
/// </summary>
public record ResultadoPerguntaResponse(
    Guid Id,
    string Texto,
    List<ResultadoOpcaoResponse> Opcoes
)
{
    public static ResultadoPerguntaResponse From(ResultadoPerguntaDto dto) => new(
        dto.Id,
        dto.Texto,
        dto.Opcoes.Select(ResultadoOpcaoResponse.From).ToList()
    );
}

/// <summary>
/// Response com estatísticas de uma opção
/// </summary>
public record ResultadoOpcaoResponse(
    Guid Id,
    string Texto,
    int Votos,
    double Percentual
)
{
    public static ResultadoOpcaoResponse From(ResultadoOpcaoDto dto) => new(
        dto.Id,
        dto.Texto,
        dto.Votos,
        dto.Percentual
    );
}
