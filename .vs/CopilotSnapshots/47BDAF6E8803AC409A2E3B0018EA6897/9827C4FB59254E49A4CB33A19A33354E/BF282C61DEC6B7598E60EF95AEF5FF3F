using Microsoft.AspNetCore.Authorization;
using Microsoft.AspNetCore.Mvc;
using QuestionarioOnline.Api.Responses;
using QuestionarioOnline.Application.DTOs.Requests;
using QuestionarioOnline.Application.DTOs.Responses;
using QuestionarioOnline.Application.Interfaces;

namespace QuestionarioOnline.Api.Controllers;

[Authorize]
[Route("api/[controller]")]
public class RespostaController : BaseController
{
    private readonly IRespostaService _respostaService;

    public RespostaController(IRespostaService respostaService)
    {
        _respostaService = respostaService;
    }

    [HttpPost]
    public async Task<ActionResult<ApiResponse<RespostaRegistradaDto>>> Registrar([FromBody] RegistrarRespostaRequest request)
    {
        var result = await _respostaService.RegistrarRespostaAsync(request);

        if (result.IsFailure)
            return FailResponse(result);

        return AcceptedResponse(result.Value, "Resposta recebida e será processada em breve");
    }
}
